<div class="container myContainer">
  <b>Benchmark des R/O all intelcia par site <span style="color: rgba(234,49,128,255);margin-left: 3px"><i *ngIf="selectedName != ''" style="margin-right: 3px" class="bi bi-flag" ></i> {{selectedName}}</span></b>
  <div class="row myRow">
    <div class="col-md-5 col-lg-4 col-sm-12 col-12 h-100">
      <b style="display: inline-block;margin-right: 2%;margin-top: 4%">Date</b>
      <select class="form-select" style="width: 40%;display: inline-block;margin-right: 2%">
      <option value="2021">2021</option>
      <option value="2020">2020</option>
      <option value="2019">2019</option>
    </select>
      <select class="form-select" style="width: 40%;display: inline-block">
        <option value="Janvier">Janvier</option>
        <option value="Fevrier">Fevrier</option>
        <option value="Mars">Mars</option>
      </select>
    </div>
    <div class="col-md-7 col-lg-5 col-sm-12 col-12 h-100 myCol">
      <b style="display: inline-block;margin-top: 3%;margin-right: 1%">Status</b>
      <button style="display: inline-block;margin-left: 2px;width: 85px" [ngClass]="buttonValidClass" (click)="changeCssValid()"><span [ngClass]="spanValidClass">Validée</span> <i [ngClass]="iconValidClass"></i></button>
      <button style="display: inline-block;width: 100px" [ngClass]="buttonAwaitClass" (click)="changeCssAwait()"><span [ngClass]="spanAwaitClass">En attente</span><i [ngClass]="iconAwaitClass"></i></button>
      <button style="display: inline-block;width: 83px" [ngClass]="buttonRejectedClass" (click)="changeCssRejected()"><span [ngClass]="spanRejectedClass">Rejetée</span><i [ngClass]="iconRejectedClass"></i></button>
    </div>
    <div class="col-lg-3 myCol col-12">
      <button (click)="exportExcel()" class="btn myBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path fill="#ECEFF1" d="M15.5 13h-7c-.276 0-.5-.224-.5-.5v-10a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v10a.5.5 0 0 1-.5.5z"/><path fill="#388E3C" d="M10.5 5h-2a.5.5 0 010-1h2a.5.5 0 010 1zM10.5 7h-2a.5.5 0 010-1h2a.5.5 0 010 1zM10.5 9h-2a.5.5 0 010-1h2a.5.5 0 010 1zM10.5 11h-2a.5.5 0 010-1h2a.5.5 0 010 1zM13.5 5h-1a.5.5 0 010-1h1a.5.5 0 010 1zM13.5 7h-1a.5.5 0 010-1h1a.5.5 0 010 1zM13.5 9h-1a.5.5 0 010-1h1a.5.5 0 010 1zM13.5 11h-1a.5.5 0 010-1h1a.5.5 0 010 1z"/><path fill="#2E7D32" d="M8.819.115a.491.491 0 0 0-.411-.106l-8 1.5A.499.499 0 0 0 0 2v11a.5.5 0 0 0 .408.491l8 1.5A.498.498 0 0 0 9 14.5V.5a.499.499 0 0 0-.181-.385z"/><path fill="#FAFAFA" d="M6.876 9.171L5.295 7.364l1.599-2.056a.5.5 0 0 0-.789-.615L4.624 6.597 3.376 5.171a.5.5 0 1 0-.752.658l1.375 1.572-1.394 1.792a.5.5 0 1 0 .79.614l1.275-1.64 1.454 1.661a.496.496 0 0 0 .705.048.5.5 0 0 0 .047-.705z"/></svg><span style="color: green">Export board to Excel</span></button>
    </div>
    <div style="margin-top: 1%;height: 40px;text-align: center;padding-top: 6px" class="col-xl-2 col-lg-4 col-md-5 col-12 myCol">
      <i class="bi bi-calendar4"></i> du <b style="font-size: small">{{dateDebut}}</b> au <b style="font-size: small">{{dateFin}}</b>
    </div>
    <div style="margin-top: 1%;height: 40px;text-align: center;padding-top: 6px" class="col-xl-2 col-lg-4 col-md-3 mx-1 me-md-auto col-12 myCol">
      <b style="font-size: small">Objectif R/O : 80%</b>
    </div>
    <div [ngClass]="{'iconVisible': selectedName != '', 'iconInvisible': selectedName === ''}" style="margin-top: 1%;height: 40px;border-right: 1px solid gray;text-align: center;padding-top: 6px" class="col-xl-2 col-lg-4 col-md-4 myCol">
      <i class="bi bi-flag" style="color: deeppink;margin-right: 4px"></i> <b style="font-size: small;color: deeppink">{{selectedName}}</b>
    </div>
    <div [ngClass]="{'iconVisible': selectedName != '', 'iconInvisible': selectedName === ''}" style="margin-top: 1%;height: 40px;border-right: 1px solid gray;text-align: center;padding-top: 6px" class="col-xl-3 col-lg-5 col-md-5 myCol">
      <b style="font-size: small">Classement : R/O Corporate : <span class="orderOne">{{selectedOne}}<span *ngIf="selectedOne === 1">er</span ><span *ngIf="selectedOne != 1">eme</span></span></b>
    </div>
    <div [ngClass]="{'iconVisible': selectedName != '', 'iconInvisible': selectedName === ''}" style="margin-top: 1%;height: 40px;border-right: 1px solid gray;text-align: center;padding-top: 6px" class="col-xl-2 col-lg-3 col-md-3 myCol">
     <b style="font-size: small">R/O Site : <div class="orderTwo">{{selectedTwo}}<span *ngIf="selectedTwo === 1">er</span ><span *ngIf="selectedTwo != 1">eme</span></div></b>
    </div>
    <div class="col-md-6 col-lg-6 col-xl-6 col-sm-12 mt-2 myPadding">
      <div class="tableTitle1">R/O Corporate</div>
      <table id="excel-table1" class="table">
        <thead>
        <tr>
          <th>Site</th>
          <th>R/O actions primaire sans CaC</th>
          <th>R/O actions secondaire</th>
          <th>R/O Total</th>
        </tr>
        </thead>
        <tbody>
        <tr class="allSite">
          <td>All Site</td>
          <td>{{roActionPrimaireSum}}%</td>
          <td>{{roActionSecondaireSum}}%</td>
          <td>{{roActionTotalSum}}%</td>
        </tr>
        <tr [ngClass]="{'firstTableTr trSelected' : selectedName == s.name, 'firstTableTr' : selectedName != s.name}" *ngFor="let s of Sitess;let i = index" (click)="selectTr(i,s.name)">
          <td [ngClass]="{'tdGreen': s.roTotal >= 50, 'tdOrange': s.roTotal < 50 && s.roTotal >=30, 'tdRed' : s.roTotal < 30, 'tdPink' : selectedName == s.name}">{{i+1}} <i class="bi bi-flag" [ngClass]="{ 'iconVisible': selectedName === s.name,'iconInvisible': selectedName != s.name}" style="color: rgba(234,49,128,255)"></i>  {{s.name}}</td>
          <td [ngClass]="{'tdGreen': s.roActionPrimaire >= 50, 'tdOrange': s.roActionPrimaire < 50 && s.roActionPrimaire >=30, 'tdRed' : s.roActionPrimaire < 30}">{{s.roActionPrimaire}}%</td>
          <td [ngClass]="{'tdGreen': s.roActionSecondaire >= 50, 'tdOrange': s.roActionSecondaire < 50 && s.roActionSecondaire >=30, 'tdRed' : s.roActionSecondaire < 30}">{{s.roActionSecondaire}}%</td>
          <td [ngClass]="{'tdGreen': s.roTotal >= 50, 'tdOrange': s.roTotal < 50 && s.roTotal >=30, 'tdRed' : s.roTotal < 30}">{{s.roTotal}}%</td>
        </tr>
        </tbody>
      </table>
    </div>
    <div class="col-md-6 col-lg-6 col-xl-6 col-sm-12 mt-2 myPadding">
      <div class="tableTitle2">R/O Site</div>
      <table id="excel-table2" class="table">
        <thead>
        <tr>
          <th>Site</th>
          <th>R/O actions primaire sans CaC</th>
          <th>R/O actions secondaire</th>
          <th>R/O Total</th>
        </tr>
        </thead>
        <tbody>
        <tr class="allSite">
          <td>All Site</td>
          <td>{{roActionPrimaireSum}}%</td>
          <td>{{roActionSecondaireSum}}%</td>
          <td>{{roActionTotalSum}}%</td>
        </tr>
        <tr [ngClass]="{'secondTableTr trSelected' : selectedName == s.name, 'secondTableTr' : selectedName != s.name}" *ngFor="let s of mixedSitess;let i = index" (click)="selectTr(i,s.name)">
          <td [ngClass]="{'tdGreen': s.roTotal >= 50, 'tdOrange': s.roTotal < 50 && s.roTotal >=30, 'tdRed' : s.roTotal < 30, 'tdPink' : selectedName == s.name}">{{i+1}} <i class="bi bi-flag" [ngClass]="{ 'iconVisible': selectedName === s.name,'iconInvisible': selectedName != s.name}"></i>  {{s.name}}</td>
          <td [ngClass]="{'tdGreen': s.roActionPrimaire >= 50, 'tdOrange': s.roActionPrimaire < 50 && s.roActionPrimaire >=30, 'tdRed' : s.roActionPrimaire < 30}">{{s.roActionPrimaire}}%</td>
          <td [ngClass]="{'tdGreen': s.roActionSecondaire >= 50, 'tdOrange': s.roActionSecondaire < 50 && s.roActionSecondaire >=30, 'tdRed' : s.roActionSecondaire < 30}">{{s.roActionSecondaire}}%</td>
          <td [ngClass]="{'tdGreen': s.roTotal >= 50, 'tdOrange': s.roTotal < 50 && s.roTotal >=30, 'tdRed' : s.roTotal < 30}">{{s.roTotal}}%</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

